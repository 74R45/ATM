<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Bank admin</title>
    <link rel="stylesheet" href="css/bank/general_bank.css">
    <link rel="stylesheet" href="css/bank/.css">
    <link rel="stylesheet" type="text/css" href="webjars/bootstrap/3.3.7/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
</head>
<body>
<div>Card: </div>
<select id="cardToUnBlock"></select>
<button id="unBlockCard">Unblock</button>
<button id="mainMenuAdmin">Main menu</button>
<script>
    window.onload = function () {
        var dataLength = localStorage.getItem("dataLength");

        var j;
        var options = [];

        for (j = 0; j < dataLength; j++) {
            options[j] = document.createElement("OPTION");

            options[j].innerHTML = localStorage.getItem("cardNum" + j);
            options[j].id = "optionToUnBlock" + j;
            console.log(options[j]);
            document.getElementById("cardToUnBlock").appendChild(options[j]);

        }
        var butUnBlock = document.getElementById("unBlockCard");
        butUnBlock.onclick = function(){
            console.log($("#cardToUnBlock").val());
            unblock_card_ajax();
        }
        var mainMenuAdmin = document.getElementById("mainMenuAdmin");
        mainMenuAdmin.onclick = function(){
            window.location.href = "adminFirstPage.html";
        }

        function unblock_card_ajax(){
            $.ajax({
                type: "POST",
                contentType: "application/json",
                url: "api/v1/account/unblock?number=" + $("#cardToUnBlock").val(),
                dataType: 'json',
                cache: false,
                timeout: 600000,
                success: function (data) {
                    console.log(data);
                    window.alert("Card is unblocked");
                },
                error: function (e) {
                    console.log("ERROR : ", e);
                }
            });
        }
    }
</script>
</body>
</html>