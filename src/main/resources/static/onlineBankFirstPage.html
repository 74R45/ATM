<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Online Bank</title>
    <link rel="stylesheet" type="text/css"
          href="webjars/bootstrap/3.3.7/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
</head>
<body>
<div class="container-fluid">
    <div class="row">
        <div class="col-6">
            <button id="checkBalanceAndTransactions" style="width: 300px; height: 200px; font-size: 30px; margin-bottom: 20px;"
                    class="btn btn-primary btn-lg">Check balance & Transaction history
            </button>
        </div>
        <div class="col-6">
            <button id="newAcc" style="width: 300px; height: 200px;font-size: 30px; margin-bottom: 20px;"
                    class="btn btn-primary btn-lg"> // New acc - NO
            </button>
        </div>
        <div class="col">
            <button id="activateCredit" style="width: 300px; height: 100px; font-size: 30px;"
                    class="btn btn-primary btn-lg">Activate credit
            </button>
        </div>
        <div class="col">
            <button id="depositMenu" style="width: 300px; height: 100px;font-size: 30px;"
                    class="btn btn-primary btn-lg">Deposit menu
            </button>
        </div>
    </div>
</div>
<script type="text/javascript" src="js/main.js"></script>

<script>
    var checkBalanceAndTransactions = document.getElementById("checkBalanceAndTransactions");
    checkBalanceAndTransactions.onclick = function () {
        console.log("CHECK ");
        check_balance_transactions();
    };

    var activateCredit = document.getElementById("activateCredit");
    activateCredit.onclick = function () {
        console.log("ACTIVATE CREDIT ");
        click_activate_credit();
    }
    function click_activate_credit() {

        $.ajax({
            type: "GET",
            contentType: "application/json",
            url: "/api/v1/user?login=" + localStorage.getItem("onlineBankLogin"),
            dataType: 'json',
            cache: false,
            timeout: 600000,
            success: function (data) {
                console.log("GET ITN BY LOGIN: ", data["itn"])
                localStorage.setItem("itn", data["itn"]);
                console.log("typeof itn");
                console.log(typeof data["itn"]);
            },
            error: function (e) {
                console.log("ERROR : ", e);
            }
        });

        $.ajax({
            type: "GET",
            contentType: "application/json",
            url: "/api/v1/account/all?itn=" + localStorage.getItem("itn"),
            dataType: 'json',
            cache: false,
            timeout: 600000,
            success: function (data) {

                localStorage.setItem("dataLength", data.length);
                var i;
                for (i = 0; i < data.length; i++) {
                    localStorage.setItem("cardNum" + i, data[i]["number"]);
                    localStorage.setItem("cardIsCredit" + i, data[i]["isCredit"]);
                    console.log("typeof ", typeof(data[i]["isCredit"]));

                    localStorage.setItem("amount" + i, data[i]["amount"]);
                    localStorage.setItem("amountCredit" + i, data[i]["amountCredit"]);
                    localStorage.setItem("creditLimit" + i, data[i]["creditLimit"]);

                }

                window.location.href = "activateCredit.html";
            },


            error: function (e) {
                console.log("ERROR : ", e);
            }
        });
    }
    function check_balance_transactions() {

        $.ajax({
            type: "GET",
            contentType: "application/json",
            url: "/api/v1/user?login=" + localStorage.getItem("onlineBankLogin"),
            //data: JSON.stringify(sumToWithdraw),
            dataType: 'json',
            cache: false,
            timeout: 600000,
            success: function (data) {
                console.log("GET ITN BY LOGIN: ", data["itn"])
                localStorage.setItem("itn", data["itn"]);
                console.log("typeof itn");
                console.log(typeof data["itn"]);
            },
            error: function (e) {
                console.log("ERROR : ", e);
            }
        });

        $.ajax({
            type: "GET",
            contentType: "application/json",
            url: "/api/v1/account/all?itn=" + localStorage.getItem("itn"),
            dataType: 'json',
            cache: false,
            timeout: 600000,
            success: function (data) {
                // console.log("GET USER INFO BY ITN: ");
                // console.log(data["0"]["number"]);
                // console.log(data["0"]["isCredit"]);
                // console.log("data.length", data.length);
                localStorage.setItem("dataLength", data.length);
                var i;
                for (i = 0; i < data.length; i++) {
                    localStorage.setItem("cardNum" + i, data[i]["number"]);
                    localStorage.setItem("cardIsCredit" + i, data[i]["isCredit"]);
                    console.log("typeof ", typeof(data[i]["isCredit"]));

                    localStorage.setItem("amount" + i, data[i]["amount"]);
                    localStorage.setItem("amountCredit" + i, data[i]["amountCredit"]);
                    localStorage.setItem("creditLimit" + i, data[i]["creditLimit"]);

                }

                window.location.href = "selectCard.html";

                },


            error: function (e) {
                console.log("ERROR : ", e);
            }
        });
    }
</script>
</body>
</html>